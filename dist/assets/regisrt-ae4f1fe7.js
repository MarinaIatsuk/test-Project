import{M as a,a as S,b as g}from"./md5-d3aef2ca.js";const u=document.forms.oneForm,s=document.getElementById("secondPassword"),l=document.getElementById("repeatPassword"),v=document.querySelector(".form__password-error"),b=document.querySelector(".form__email-error");function _(e){function t(o){e.nextElementSibling.textContent=o,e.classList.add("error")}t(""),e.classList.remove("error");let n=e.validity;return n.rangeUnderflow?(t("Значение меньше минимально допустимого"),!1):n.rangeOverflow?(t("Значение больше максимального допустимого"),!1):n.tooShort?(t("Значение слишком короткое"),!1):n.tooLong?(t("Значение слишком длинное"),!1):n.valueMissing?(t("Необходимо заполнить поле"),!1):!0}const p=document.querySelectorAll('input[name="secondName"]'),k=Array.from(p);function d(){let e=!0;for(let o of k)_(o)||(e=!1);const t=/^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[a-z])(?=.*[A-Z]).{8,}$/,n=/[a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+/i;if(t.test(s.value)||(e=!1,v.innerHTML=" Пароль должен: содержать хотя бы одну большую букву, хотя бы одну маленькую букву, хотя бы одну цифру, хотя бы один спецсимвол(!@#$%^&*);",s.classList.add("error")),n.test(m.value)||(e=!1,b.innerHTML="Неверный формат заполнения"),l.value!==s.value)l.nextElementSibling.textContent="Пароли не совпадают",l.classList.add("error"),e=!1;else return e}const i=u.elements.secondCheckbox,r=document.querySelector("#btnText");r.disabled=!0;i.addEventListener("change",()=>{i.checked?r.disabled=!1:r.disabled=!0});u.addEventListener("submit",e=>{e.preventDefault(),d()});const c=document.querySelector("#textName"),m=document.querySelector("#textEmail"),x=document.querySelector("#repeatPassword"),q=document.querySelector("#textSecret"),E=document.querySelector("#invisibleOne"),L=document.querySelector("#invisibleTwo"),h=document.querySelector(".see"),C=document.querySelector("#resultOk"),I=document.querySelector(".form__email-error");r.addEventListener("click",async()=>{if(!d())return;r.disabled=!0;const e={name:c.value,password:a(x.value).toString(),email:m.value,secret:a(q.value).toString(),likes:{}};if((await S("users","email",e.email)).length>0)I.textContent="пользователь с таким email существует";else{let n=await g("users",e);E.style.display="none",L.style.display="none",h.style.display="flex",C.innerHTML=`
        <div class="main-reg__ok">
        <p class="main-reg__ok-text">Вы успешно зарегестрировались</p>
        <a class="main-reg__ok-link" href="./index.html">главная страница</a>
    </div>
        `;let o=new Date().getTime();const f={id:n,name:c.value,time:o},y=JSON.stringify(f);window.localStorage.setItem("client",y);const w=window.localStorage.getItem("client");JSON.parse(w)}r.disabled=!1});const O=document.querySelector("#btnComeIn");function T(){window.open(window.location.origin+"?login=true","_self")}O.addEventListener("click",T);
